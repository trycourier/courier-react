<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title><%= htmlWebpackPlugin.options.title %></title>
    <style>
      body {
        cursor: default;
        font-family: "Nunito Sans", sans-serif;
        margin: 0;
        padding: 32px;
        background-color: #f0f0f0;
      }
    </style>
    <script type="text/javascript">
      const userId = "3b17362c-0c91-4fcd-a829-885a2343eb67";
      /* window.loadCourier = function (config) {
        if (!config || !config.clientKey || !config.userId) {
          return Promise.reject();
        }
        window.courierConfig = { ...config };

        return new Promise((resolve) => {
          var src =
            "https://courier-components-xvdza5.s3.amazonaws.com/latest.js";
          (function () {
            var d = document;
            var s = d.createElement("script");
            s.type = "text/javascript";
            s.onload = resolve;
            s.charset = "utf-8";
            s.async = true;
            s.src = src;
            document.body.appendChild(s);
          })();
        });
      };*/
      window.courierConfig = {
        inboxApiUrl:
          "https://3rjq5oe9b1.execute-api.us-east-1.amazonaws.com/dev/q",
        apiUrl:
          "https://rubmz24skk.execute-api.us-east-1.amazonaws.com/dev/client/q",
        wsOptions: {
          url: "wss://20en15n3ng.execute-api.us-east-1.amazonaws.com/dev",
        },
        clientKey: "NzY4MjUxY2YtM2ViOC00MjZhLTkyZWItZmFhMGU3Njc4NzY4",

        // JWT SMOKEY
        //clientKey: "YzQzMGM3OGYtYzQ2NC00NTdjLThkM2QtNWIwYzI4OTdmYmE5",
        //userId: "smokey12345",

        userId: "70f6a4f4-2907-4518-b8f3-b9cfab224764",
        components: {
          inbox: {
            theme: {
              message: {
                actionElement: {
                  "&:last-child": {
                    backgroundColor: "purple",
                    color: "white",
                  },
                },
              },
            },
            onEvent: (params) => {
              console.log("params", params);
              if (
                params.event === "read" &&
                window.courier.inbox.pinned.find(
                  (p) => p.messageId === params.messageId
                )
              ) {
                window.courier.inbox.unpinMessage(params.messageId);
              }
            },
            views: [
              {
                id: "messages",
                label: "Messages!",
                params: {
                  archived: false,
                },
              },
              {
                id: "archived",
                label: "Archived",
                params: {
                  archived: true,
                },
              },
            ],
          },
        },
      };

      window.addInbox = () => {
        const existingComponent = document.querySelector("courier-inbox");
        if (existingComponent) {
          existingComponent.remove();

          setTimeout(() => {
            const inbox = document.createElement("courier-inbox");
            document.body.appendChild(inbox);
          }, 2000);
          return;
        }

        const inbox = document.createElement("courier-inbox");
        document.body.appendChild(inbox);
      };
    </script>
  </head>
  <body>
    <courier-inbox></courier-inbox>
    <courier-toast></courier-toast>
    <div id="root" />
  </body>
</html>
